Program adaptation based on program transformation