Algorithms and data structures for flash memories