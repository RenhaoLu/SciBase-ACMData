Synchronous digital circuits as functional programs