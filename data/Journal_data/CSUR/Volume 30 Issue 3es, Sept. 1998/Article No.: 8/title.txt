Modal types as staging specifications for run-time code generation