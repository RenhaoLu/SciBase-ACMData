Recovery within long-running transactions