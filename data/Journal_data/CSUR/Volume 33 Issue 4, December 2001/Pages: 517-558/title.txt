Formalizing the safety of Java, the Java virtual machine, and Java card