Bucket elimination: a unifying framework for processing hard and soft constraints