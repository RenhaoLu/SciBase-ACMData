Design and analysis of hierarchical software metrics